---
title: 内存带宽
---

[toc]

TIPS:由于现代CPU对南北桥芯片的不断整合,越来越多的前端总线瓶颈会编程内存通道带宽来体现.

`内存带宽计算公式：带宽=内存核心频率×倍增系数×内存总线位数`

内存从SDRAM发展至今DDR4，其改变如下：
1. DDR采用时钟脉冲上升、下降沿各传一次数据，1个时钟信号可以传输2倍于SDRAM的数据，所以又称为双倍速率SDRAM。它的倍增系数就是2。
2. DDR2仍然采用时钟脉冲上升、下降支各传一次数据的技术（不是传2次），但是一次预读4bit数据，是DDR一次预读2bit的2倍，因此，它的倍增系数是2X2=4。
3. DDR3作为DDR2的升级版，最重要的改变是一次预读8bit，是DDR2的2倍，DDR的4倍，所以，它的倍增系数是2X2X2=8。
4. DDR4，较为复杂。DDR4如果要继续在物理频率不增加的情况下达到高传输性能，只有两种方法。其一就是增加预取位到16bit;其二就是采用多总线技术。GDDR5显存就使用了双总线技术来达到极高的内存带宽和标称频率。比如GDDR5 5000显存，由于采用双总线技术，我们可以将其看作两颗“GDDR5 2500”并行运行，每颗“GDDR5 2500”预取位数为8bit，两颗组成的“双通道”，预取位数可以看作16bit。

==TIPS==:这里最主要改变的参数就是倍增系数,由于于都取位数的变化,倍增系数分别是 2,4,8,16.

内存频率由三种不同的指标,他们分别是核心频率、时钟频率和有效数据传输频率。
- 核心频率,物理频率即为内存Cell阵列(Memory Cell Array)的工作频率，它是内存的真实运行频率；
- 时钟频率即I/O Buffer（输入/输出缓存）的传输频率；
- 有效数据传输频率则是指数据传送的频率。我们可以简单的把内存商品的标称频率拿来用就好了,不超频.

==TIPS==:内存名称上的数字则是标称频率，其实并不是物理频率。如DDR 400、DDR2 800、DDR3 1600和DDR4 3200的物理运行频率都是200MHz，物理频率必须乘上倍增系数才能获得相应的标称频率。标称频率是以老旧的SDRAM内存为基准，换算得出利于商业运作和产品标识的频率。

内存物理频率与标称频率的列表：

- 100MHz - DDR200，DDR2 400，DDR3 800，DDR4 1600
- 133MHz - DDR266，DDR2 533，DDR3 1067，DDR4 2133
- 166MHz - DDR333，DDR2 667，DDR3 1333，DDR4 2666
- 200MHz - DDR400，DDR2 800，DDR3 1600，DDR4 3200
- 233MHz - DDR3 1887，DDR4 3733,
- 266MHz - DDR2 1066，DDR3 2133，DDR4 4266

从SDRAM-DDR时代，数据总线位宽时钟没有改变，都为64bit，但是采用双通道技术，可以获得64X2=128bit的位宽。如果采用四通道技术，可以达到256bit位宽。那么八通道,就可以达到512bit位宽.

我们回到现实采用的CPU, AMD EPYC 7302.它标称内存带宽每路是204.8GB/s.怎么算的呢:

![AMD EPYC 7302](https://raw.githubusercontent.com/OliverRen/olili_blog_img/master/内存带宽/20201015/1602746481018.png)

- DDR 3200其实工作核心频率是200MHz
- DDR4 内存的倍率是16,我们计算可以直接使用3200MHz标称来算
- 8通道的位宽是 512bit

所以 200MHz * 16 * 512bit / 8(bit/byte) /1000(M/G) =204.8GB/s